(function(){"use strict";angular.module("formz",["bootstrap","formz.controllers","formz.filters","formz.services","formz.directives"]).config(["$routeProvider",function(e){e.when("/form/:id",{templateUrl:"partials/form.html"}),e.otherwise({redirectTo:"/form/human"})}]),angular.module("formz.controllers",["ngResource"]),angular.module("formz.filters",[]),angular.module("formz.services",["ngResource"]),angular.module("formz.directives",[])})(),function(){"use strict";angular.module("formz.services").service("fzXsd",["fzXml",function(e){function n(n,r){return e.select(n,r,b)}function r(n,r){return e.selectOne(n,r,b)}function t(n,t){var i=e.documentElement(n),u=r(i,t);return u}function i(r){angular.isString(r)&&(r=e.parse(r));var t=w(r),i=n(r,"xs:schema")[0];return{namespace:i.getAttribute("targetNamespace"),rootElement:t}}function u(e){return r(e,"xs:annotation/xs:appinfo/ui:info")}function o(e,n){angular.isUndefined(n)&&(n="");var r=u(e);if(null===r)return n;var t=r.getAttribute("label");return null!==t?t:n}function l(e){var n=u(e);if(null===n)return"";var r=n.getAttribute("placeholder");return null!==r?r:""}function a(n){var r=e.selectOne(n,"xs:annotation/xs:documentation");return null===r?".no-help":r.textContent}function c(e,n){return e.label=o(n,e.name),e.documentation=a(n),e.placeholder=l(n),e}function s(e){var n={name:"@"+e.getAttribute("name")},r=e.getAttribute("use");n.required=null===r||"optional"===r?!1:!0;var t=x(e);return null!==t&&(n="string"==typeof t?z(n,t):p(n,t)),c(n,e)}function f(n,r){var t=e.select(r,"xs:attribute");if(0===t.length)return n;var i=_.map(t,function(e){return s(e)});return n.children=_.union(n.children,i),n}function d(n,r){var i=e.selectOne(r,"xs:attributeGroup/@ref");if(null===i)return n;var u=t(r,'//xs:attributeGroup[@name="'+i.value+'"]');if(null===u)throw Error('xsd service: Could not find a referenced attributeGroup named "'+i.value+'".');return n=f(n,u)}function m(e,n){return e=f(e,n),e=d(e,n)}function v(n,r){var t=e.selectOne(r,"xs:complexContent/xs:extension");if(null===t)return n;n=m(n,t);var i=x(t);return null!==i?(n=v(n,i),n=m(n,i)):n}function g(n,r){var t=e.selectOne(r,"xs:restriction");return null===t?n:(void 0===n.restrictions&&(n.restrictions={}),n.restrictions.minLength=parseInt(e.getValue(t,"xs:minLength/@value",0),10),n)}function p(e,n){return e=c(e,n),"complexType"===n.localName?(e=v(e,n),e=m(e,n)):e=g(e,n),e}function h(e){return e.type="string",e.restrictions={},e.restrictions.minLength=0,e}function z(e,n){if("xs:string"===n)return h(e);throw Error('xsd service: Could not parse a standard type names "'+n+'".')}function x(e){var n=e.getAttribute("type");if(null===n&&(n=e.getAttribute("base")),null===n)return null;if(/^xs:/.test(n))return n;var r=t(e,'//xs:complexType[@name="'+n+'"] | //xs:simpleType[@name="'+n+'"]');if(null===r)throw Error('xsd service: Could not find a referenced type named "'+n+'".');return r}function w(n){var r=e.selectOne(n,"/xs:schema/xs:element");if(null===r)throw Error("xsd service: Could not find a root element definition on this Xml Schema.");var t={name:r.getAttribute("name"),children:[]},i=x(r);if(null!==i){if("string"!=typeof i)return p(t,i);t=z(t,i)}return t=c(t,r),t=m(t,r)}var b={xs:"http://www.w3.org/2001/XMLSchema",ui:"http://formz.com/UI"};return{parse:i}}])}(),function(){"use strict";angular.module("formz.services").service("fzXml",function(){function e(e){var n;if(window.DOMParser){var r=new window.DOMParser;n=r.parseFromString(e,"text/xml")}else 0===e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(e);return n}function n(e){return window.DOMParser?(new XMLSerializer).serializeToString(e):e.xml}function r(e){return null===e.ownerDocument?e.documentElement:e.ownerDocument.documentElement}function t(e,n,t){var i;i=angular.isDefined(t)?function i(e){return t[e]||null}:document.createNSResolver(r(e));for(var u=document.evaluate(n,e,i,XPathResult.ANY_TYPE,null),o=[],l=u.iterateNext();l;)o.push(l),l=u.iterateNext();return o}function i(e,n,r){var i=t(e,n,r);return 0===i.length?null:i[0]}function u(e,n,r,t){angular.isUndefined(r)&&(r=null);var u=i(e,n,t);return null===u||angular.isUndefined(u.nodeValue)||null===u.nodeValue?r:u.nodeValue}return{parse:e,toString:n,documentElement:r,select:t,selectOne:i,getValue:u}})}(),function(){"use strict";angular.module("formz.services").service("fzModel2Xml",function(){function e(e){return angular.isUndefined(e)||null===e?"":n("",e.rootElement,e.namespace)}function n(e,n,l){var a=_.filter(n.children,function(e){return/^@/.test(e.name)}),c=_.difference(n.children,a);return e=o(e,"<"+n.name),e=r(e,l),e=u(e,a),e+=">",e=i(e,n.value),e=t(e,c),e=o(e,"</"+n.name+">")}function r(e,n){return null!==n&&void 0!==n&&(e=o(e,' xmlns="'+n+'"')),e}function t(e,r){return e=_.reduce(r,function(e,r){return n(e,r)},e)}function i(e,n){return angular.isDefined(n)&&null!==n&&(e=o(e,n)),e}function u(e,n){return e+=_.reduce(n,function(e,n){var r=e+" "+n.name.substring(1)+'="';return angular.isDefined(n.value)&&null!==n.value&&(r+=n.value),r+'"'},"")}function o(e,n){return e+=n}return{toString:e}})}(),function(){"use strict";angular.module("formz.services").service("fzLocalization",["$resource","$cacheFactory","$locale",function(e,n,r){function t(e){var n=i.get("strings");return n||(n=u.get(angular.noop),i.put("strings",n)),angular.isUndefined(n[e])?e:n[e]}var i=n("fzLocalization"),u=e("locales/:localeId.js",{localeId:r.id});return{string:t}}])}(),function(){"use strict";var e=angular.module("formz.controllers");e.controller("XsdCtrl",["$scope","$http","fzXsd","$routeParams","fzLocalization",function(e,n,r,t,i){e.save=function(){e.showXml=!0},e.showXml=!1,e.locales=i,n.get("xsd/"+t.id+".xsd").success(function(n){e.form=r.parse(n)})}]),e.controller("MainCtrl",["$scope","$resource","fzLocalization",function(e,n,r){e.locales=r;var t=n("xsd/formsDefinitions.js");e.forms=t.query(function(){e.tabs=_.pluck(e.forms,"label")})}]),e.controller("TabsCtrl",["$scope","$routeParams","$location",function(e,n,r){e.currentTab=n.id,e.$watch("currentTab",function(e,n){e!==n&&r.path("/form/"+e)})}])}(),function(){"use strict";angular.module("formz.filters",[]).filter("asXml",["fzModel2Xml",function(e){return function(n){return e.toString(n)}}])}(),function(){"use strict";angular.module("formz.directives").directive("fzField",function(){return{restrict:"EA",replace:!0,controller:["$scope","fzLocalization",function(e,n){e.locales=n,e.$watch("data.value",function(){e.controlGroupClasses=e.fieldForm.input.$dirty&&e.fieldForm.input.$invalid?"error":""})}],scope:{data:"="},templateUrl:"partials/directives/fzField.html"}})}(),function(){"use strict";angular.module("formz.directives").directive("fzFieldset",function(){return{restrict:"EA",replace:!0,controller:["$scope","fzLocalization",function(e,n){e.locales=n}],scope:{data:"="},templateUrl:"partials/directives/fzFieldSet.html"}})}(),function(){"use strict";angular.module("formz.directives").directive("fzMarkdown",function(){var e=new Showdown.converter;return{restrict:"A",link:function(n,r,t){t.$observe("text",function(n){var t=e.makeHtml(n);r.html(t)})}}})}(),function(){"use strict";var e=angular.module("formz.directives");e.directive("fzMinlength",function(){return{require:"ngModel",link:function(e,n,r,t){var i=e.$eval(r.fzMinlength);t.$parsers.unshift(function(e){return e.length>=i?(t.$setValidity("minlength",!0),e):(t.$setValidity("minlength",!1),void 0)})}}})}();